/*
 * This file was generated automatically by xsubpp version 1.9508 from the
 * contents of BibTeX.xs. Do not edit this file, edit BibTeX.xs instead.
 *
 *	ANY CHANGES MADE HERE WILL BE LOST!
 *
 */

#line 1 "BibTeX.xs"
/* ------------------------------------------------------------------------
@NAME       : BibTeX.xs
@INPUT      : 
@OUTPUT     : 
@RETURNS    : 
@DESCRIPTION: Glue between my `btparse' library and the Perl module
              Text::BibTeX.  Provides the following functions to Perl:
                 Text::BibTeX::constant
                 Text::BibTeX::initialize
                 Text::BibTeX::cleanup
                 Text::BibTeX::split_list
                 Text::BibTeX::purify_string
                 Text::BibTeX::Entry::_parse_s
                 Text::BibTeX::Entry::_parse
                 Text::BibTeX::Name::split
                 Text::BibTeX::Name::free
                 Text::BibTeX::add_macro_text
                 Text::BibTeX::delete_macro
                 Text::BibTeX::delete_all_macros
                 Text::BibTeX::macro_length
                 Text::BibTeX::macro_text
@GLOBALS    : 
@CALLS      : 
@CREATED    : Jan/Feb 1997, Greg Ward
@MODIFIED   : 
@VERSION    : $Id: BibTeX.xs 3031 2006-09-21 20:02:34Z ambs $
-------------------------------------------------------------------------- */
#include "EXTERN.h"
#include "perl.h"
#include "XSUB.h"

#define BT_DEBUG 0

#include "btparse.h"
#include "btxs_support.h"


#line 48 "BibTeX.c"
XS(XS_Text__BibTeX_constant); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX_constant)
{
    dXSARGS;
    if (items != 1)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::constant(name)");
    {
	char *	name = (SvOK (ST(0))) ? (char *) SvPV (ST(0),PL_na) : NULL;
	SV *	RETVAL;
#line 48 "BibTeX.xs"
	IV i;
	if (constant(name, &i))
	    ST(0) = sv_2mortal(newSViv(i));
	else
	    ST(0) = &PL_sv_undef;
#line 64 "BibTeX.c"
    }
    XSRETURN(1);
}

XS(XS_Text__BibTeX_initialize); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX_initialize)
{
    dXSARGS;
    if (items != 0)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::initialize()");
    {

	bt_initialize();
    }
    XSRETURN_EMPTY;
}

XS(XS_Text__BibTeX_cleanup); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX_cleanup)
{
    dXSARGS;
    if (items != 0)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::cleanup()");
    {

	bt_cleanup();
    }
    XSRETURN_EMPTY;
}

XS(XS_Text__BibTeX_split_list); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX_split_list)
{
    dXSARGS;
    if (items < 2 || items > 5)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::split_list(string, delim, filename=NULL, line=0, description=NULL)");
    SP -= items;
    {
	char *	string = (SvOK (ST(0))) ? (char *) SvPV (ST(0),PL_na) : NULL;
	char *	delim = (SvOK (ST(1))) ? (char *) SvPV (ST(1),PL_na) : NULL;
	char *	filename;
	int	line;
	char *	description;
#line 85 "BibTeX.xs"
       bt_stringlist *
             names;
       int   i;
       SV *  sv_name;

#line 114 "BibTeX.c"

	if (items < 3)
	    filename = NULL;
	else {
	    filename = (SvOK (ST(2))) ? (char *) SvPV (ST(2),PL_na) : NULL;
	}

	if (items < 4)
	    line = 0;
	else {
	    line = (int)SvIV(ST(3));
	}

	if (items < 5)
	    description = NULL;
	else {
	    description = (SvOK (ST(4))) ? (char *) SvPV (ST(4),PL_na) : NULL;
	}
#line 91 "BibTeX.xs"
       names = bt_split_list (string, delim, filename, line, description);
       if (names == NULL)
          XSRETURN_EMPTY;       /* return empty list to perl */

       EXTEND (sp, names->num_items);
       for (i = 0; i < names->num_items; i++)
       {
          if (names->items[i] == NULL)
             sv_name = &PL_sv_undef;
          else
             sv_name = sv_2mortal (newSVpv (names->items[i], 0));

          PUSHs (sv_name);
       }

       bt_free_list (names);
#line 150 "BibTeX.c"
	PUTBACK;
	return;
    }
}

XS(XS_Text__BibTeX_purify_string); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX_purify_string)
{
    dXSARGS;
    if (items < 1 || items > 2)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::purify_string(instr, options=0)");
    {
	char *	instr = (SvOK (ST(0))) ? (char *) SvPV (ST(0),PL_na) : NULL;
	int	options;
	SV *	RETVAL;

	if (items < 2)
	    options = 0;
	else {
	    options = (int)SvIV(ST(1));
	}
#line 116 "BibTeX.xs"
       if (instr == NULL)               /* undef in, undef out */
          XSRETURN_EMPTY;
       RETVAL = newSVpv (instr, 0);
       bt_purify_string (SvPVX (RETVAL), (ushort) options);
       SvCUR_set (RETVAL, strlen (SvPVX (RETVAL))); /* reset SV's length */

#line 179 "BibTeX.c"
	ST(0) = RETVAL;
	sv_2mortal(ST(0));
    }
    XSRETURN(1);
}

XS(XS_Text__BibTeX_change_case); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX_change_case)
{
    dXSARGS;
    if (items < 2 || items > 3)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::change_case(transform, string, options=0)");
    {
	char	transform = (char)*SvPV_nolen(ST(0));
	char *	string = (SvOK (ST(1))) ? (char *) SvPV (ST(1),PL_na) : NULL;
	int	options;
	SV *	RETVAL;

	if (items < 3)
	    options = 0;
	else {
	    options = (int)SvIV(ST(2));
	}
#line 152 "BibTeX.xs"
       DBG_ACTION
          (1, printf ("XSUB change_case: transform=%c, string=%p (%s)\n",
                      transform, string, string))                  
       if (string == NULL)
          XSRETURN_EMPTY;
       RETVAL = newSVpv (string, 0);
       bt_change_case (transform, SvPVX (RETVAL), (ushort) options);

#line 212 "BibTeX.c"
	ST(0) = RETVAL;
	sv_2mortal(ST(0));
    }
    XSRETURN(1);
}

XS(XS_Text__BibTeX__Entry__parse); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX__Entry__parse)
{
    dXSARGS;
    if (items < 3 || items > 4)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::Entry::_parse(entry_ref, filename, file, preserve=FALSE)");
    {
	SV *	entry_ref = ST(0);
	char *	filename = (SvOK (ST(1))) ? (char *) SvPV (ST(1),PL_na) : NULL;
	FILE *	file = PerlIO_findFILE(IoIFP(sv_2io(ST(2))));
	boolean	preserve;
#line 181 "BibTeX.xs"
        ushort  options = 0;
        boolean status;
        AST *   top;

#line 235 "BibTeX.c"
	int	RETVAL;
	dXSTARG;

	if (items < 4)
	    preserve = FALSE;
	else {
	preserve = (SvOK (ST(3))) ? (int) SvIV (ST(3)) : 0;
	}
#line 187 "BibTeX.xs"
        top = bt_parse_entry (file, filename, options, &status);
        DBG_ACTION 
           (2, dump_ast ("BibTeX.xs:parse: AST from bt_parse_entry():\n", top))

        if (!top)                  /* at EOF -- return false to perl */
        {
           XSRETURN_NO;
        }

        ast_to_hash (entry_ref, top, status, preserve);
        XSRETURN_YES;              /* OK -- return true to perl */
#line 256 "BibTeX.c"
    }
    XSRETURN(1);
}

XS(XS_Text__BibTeX__Entry__parse_s); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX__Entry__parse_s)
{
    dXSARGS;
    if (items < 2 || items > 3)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::Entry::_parse_s(entry_ref, text, preserve=FALSE)");
    {
	SV *	entry_ref = ST(0);
	char *	text = (SvOK (ST(1))) ? (char *) SvPV (ST(1),PL_na) : NULL;
	boolean	preserve;
#line 207 "BibTeX.xs"
        ushort  options = 0;
        boolean status;
        AST *   top;

#line 276 "BibTeX.c"
	int	RETVAL;
	dXSTARG;

	if (items < 3)
	    preserve = FALSE;
	else {
	preserve = (SvOK (ST(2))) ? (int) SvIV (ST(2)) : 0;
	}
#line 213 "BibTeX.xs"
        top = bt_parse_entry_s (text, NULL, 1, options, &status);

        if (!top)                  /* no entry found -- return false to perl */
        {
           XSRETURN_NO;
        }

        ast_to_hash (entry_ref, top, status, preserve);
        XSRETURN_YES;              /* OK -- return true to perl */
#line 295 "BibTeX.c"
    }
    XSRETURN(1);
}

#if BT_DEBUG
#define XSubPPtmpAAAA 1

XS(XS_Text__BibTeX__Name_dump_name); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX__Name_dump_name)
{
    dXSARGS;
    if (items != 1)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::Name::dump_name(hashref)");
    {
	SV *	hashref = ST(0);
#line 238 "BibTeX.xs"
       HV *       hash;
       SV **      sv_name;
       bt_name  * name;

#line 316 "BibTeX.c"
#line 243 "BibTeX.xs"
       hash = (HV *) SvRV (hashref);
       sv_name = hv_fetch (hash, "_cstruct", 8, 0);
       if (! sv_name)
       {
          warn ("Name::dump: no _cstruct member in hash");
       }
       else
       { 
          name = (bt_name *) SvIV (*sv_name);
          dump_name (name);             /* currently in format_name.c */
       }
#line 329 "BibTeX.c"
    }
    XSRETURN_EMPTY;
}

#endif
XS(XS_Text__BibTeX__Name__split); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX__Name__split)
{
    dXSARGS;
    if (items != 6)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::Name::_split(name_hashref, name, filename, line, name_num, keep_cstruct)");
    {
	SV *	name_hashref = ST(0);
	char *	name = (SvOK (ST(1))) ? (char *) SvPV (ST(1),PL_na) : NULL;
	char *	filename = (SvOK (ST(2))) ? (char *) SvPV (ST(2),PL_na) : NULL;
	int	line = (int)SvIV(ST(3));
	int	name_num = (int)SvIV(ST(4));
	int	keep_cstruct = (int)SvIV(ST(5));
#line 269 "BibTeX.xs"
       HV *      name_hash;
       SV *      sv_old_name;
       bt_name * old_name;
       bt_name * name_split;

#line 354 "BibTeX.c"
#line 275 "BibTeX.xs"
       if (! (SvROK (name_hashref) && 
              SvTYPE (SvRV (name_hashref)) == SVt_PVHV))
          croak ("name_hashref is not a hash reference");
       name_hash = (HV *) SvRV (name_hashref);

       DBG_ACTION (1, 
       {
          printf ("XS Name::_split:\n");
          printf ("  name_hashref=%p, name_hash=%p\n", 
                  (void *) name_hashref, (void *) name_hash);
          printf ("  name=%p (%s), filename=%p (%s)\n",
                  name, name, filename, filename);
          printf ("  line=%d, name_num=%d, keep_cstruct=%d\n",
                  line, name_num, keep_cstruct);
       })

       sv_old_name = hv_delete (name_hash, "_cstruct", 8, 0);
       if (sv_old_name)
       {
          old_name = (bt_name *) SvIV (sv_old_name);
          DBG_ACTION
             (1, printf ("XS Name::_split: name hash had old C structure "
                         "(%d tokens, first was >%s<) -- freeing it\n",
                         old_name->tokens->num_items,
                         old_name->tokens->items[0]))
          bt_free_name (old_name);
       }

       name_split = bt_split_name (name, filename, line, name_num);
       DBG_ACTION (1, printf ("XS Name::_split: back from bt_split_name, "
                              "calling store_stringlist x 4\n"))

       store_stringlist (name_hash, "first", 
                         name_split->parts[BTN_FIRST],
                         name_split->part_len[BTN_FIRST]);
       store_stringlist (name_hash, "von", 
                         name_split->parts[BTN_VON],
                         name_split->part_len[BTN_VON]);
       store_stringlist (name_hash, "last", 
                         name_split->parts[BTN_LAST],
                         name_split->part_len[BTN_LAST]);
       store_stringlist (name_hash, "jr", 
                         name_split->parts[BTN_JR],
                         name_split->part_len[BTN_JR]);

       DBG_ACTION (1, 
       {
          char ** last = name_split->parts[BTN_LAST];
          char ** first = name_split->parts[BTN_FIRST];

          printf ("XS Name::_split: name has %d tokens; "
                 "last[0]=%s, first[0]=%s\n",
                 name_split->tokens->num_items,
                 last ? last[0] : "*no last name*",
                 first ? first[0] : "*no first name*");
       })

       if (keep_cstruct)
       {
          hv_store (name_hash, "_cstruct", 8, newSViv ((IV) name_split), 0);
          DBG_ACTION 
             (1, printf ("XS Name::_split: storing pointer to structure %p\n", 
                         name_split))
       }
       else
       {
          bt_free_name (name_split);
       }
#line 424 "BibTeX.c"
    }
    XSRETURN_EMPTY;
}

XS(XS_Text__BibTeX__Name_free); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX__Name_free)
{
    dXSARGS;
    if (items != 1)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::Name::free(name_hashref)");
    {
	SV *	name_hashref = ST(0);
#line 350 "BibTeX.xs"
       HV *      name_hash;
       SV **     sv_name;
       bt_name * name;

#line 442 "BibTeX.c"
#line 355 "BibTeX.xs"
       name_hash = (HV *) SvRV (name_hashref);
       sv_name = hv_fetch (name_hash, "_cstruct", 8, 0);
       if (sv_name != NULL)
       {
          name = (bt_name *) SvIV (*sv_name);
          DBG_ACTION (1, printf ("XS Name::free: freeing name %p\n", name))
          bt_free_name (name);
       }
#if BT_DEBUG >= 1
       else
       {
          printf ("XS Name::free: no C structure to free!\n");
       }
#endif
#line 458 "BibTeX.c"
    }
    XSRETURN_EMPTY;
}

XS(XS_Text__BibTeX__NameFormat_create); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX__NameFormat_create)
{
    dXSARGS;
    if (items < 0 || items > 2)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::NameFormat::create(parts=\"fvlj\", abbrev_first=FALSE)");
    {
	char *	parts;
	bool	abbrev_first;
#line 380 "BibTeX.xs"
#line 473 "BibTeX.c"
	IV	RETVAL;
	dXSTARG;

	if (items < 1)
	    parts = "fvlj";
	else {
	    parts = (SvOK (ST(0))) ? (char *) SvPV (ST(0),PL_na) : NULL;
	}

	if (items < 2)
	    abbrev_first = FALSE;
	else {
	abbrev_first = (SvOK (ST(1))) ? (int) SvIV (ST(1)) : 0;
	}
#line 381 "BibTeX.xs"
       DBG_ACTION 
          (1, printf ("XS NameFormat::create: "
                      "creating name format: parts=\"%s\", abbrev=%d\n",
                      parts, abbrev_first));
       RETVAL = (IV) bt_create_name_format (parts, abbrev_first);

#line 495 "BibTeX.c"
	XSprePUSH; PUSHi((IV)RETVAL);
    }
    XSRETURN(1);
}

XS(XS_Text__BibTeX__NameFormat_free); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX__NameFormat_free)
{
    dXSARGS;
    if (items != 1)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::NameFormat::free(format)");
    {
	bt_name_format *        format = (bt_name_format *) SvIV (ST(0));
#line 396 "BibTeX.xs"
       bt_free_name_format ((bt_name_format *) format);
#line 511 "BibTeX.c"
    }
    XSRETURN_EMPTY;
}

#if BT_DEBUG
#define XSubPPtmpAAAB 1

XS(XS_Text__BibTeX__NameFormat_dump_format); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX__NameFormat_dump_format)
{
    dXSARGS;
    if (items != 1)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::NameFormat::dump_format(hashref)");
    {
	SV *	hashref = ST(0);
#line 406 "BibTeX.xs"
       HV *             hash;
       SV **            sv_format;
       bt_name_format * format;

#line 532 "BibTeX.c"
#line 411 "BibTeX.xs"
       hash = (HV *) SvRV (hashref);
       sv_format = hv_fetch (hash, "_cstruct", 8, 0);
       if (! sv_format)
       {
          warn ("NameFormat::dump: no _cstruct member in hash");
       }
       else
       { 
          format = (bt_name_format *) SvIV (*sv_format);
          dump_format (format);         /* currently in format_name.c */
       }
#line 545 "BibTeX.c"
    }
    XSRETURN_EMPTY;
}

#endif
XS(XS_Text__BibTeX__NameFormat__set_text); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX__NameFormat__set_text)
{
    dXSARGS;
    if (items != 6)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::NameFormat::_set_text(format, part, pre_part, post_part, pre_token, post_token)");
    {
	bt_name_format *        format = (bt_name_format *) SvIV (ST(0));
	bt_namepart	part = (bt_namepart)SvIV(ST(1));
	char *	pre_part = (SvOK (ST(2))) ? (char *) SvPV (ST(2),PL_na) : NULL;
	char *	post_part = (SvOK (ST(3))) ? (char *) SvPV (ST(3),PL_na) : NULL;
	char *	pre_token = (SvOK (ST(4))) ? (char *) SvPV (ST(4),PL_na) : NULL;
	char *	post_token = (SvOK (ST(5))) ? (char *) SvPV (ST(5),PL_na) : NULL;
#line 436 "BibTeX.xs"
#if BT_DEBUG >= 2
    {
       static char * nameparts[] =
          { "first", "von", "last", "jr" };
       static char * joinmethods[] =
          {"may tie", "space", "force tie", "nothing"};

       printf ("XS NameFormat::_set_text:\n");
       printf ("  format=%p, namepart=%d (%s)\n", 
               format, part, nameparts[part]);
       printf ("  format currently is:\n");
       dump_format (format);
       printf ("  pre_part=%s, post_part=%s\n", pre_part, post_part);
       printf ("  pre_token=%s, post_token=%s\n", pre_token, post_token);
    }
#endif

       /*
        * No memory leak here -- just copy the pointers.  At first
        * blush, it might seem that we're opening ourselves up to
        * the possibility of dangling pointers if the Perl strings
        * that these char *'s refer to ever go away.  However, this
        * is taken care of at the Perl level -- see the comment
        * in BibTeX/NameFormat.pm, sub set_text.
        */

       bt_set_format_text (format, part,
                           pre_part, post_part, pre_token, post_token);
#if BT_DEBUG >= 2
       printf ("XS NameFormat::_set_text: after call, format is:\n");
       dump_format (format);
#endif
#line 597 "BibTeX.c"
    }
    XSRETURN_EMPTY;
}

XS(XS_Text__BibTeX__NameFormat__set_options); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX__NameFormat__set_options)
{
    dXSARGS;
    if (items != 5)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::NameFormat::_set_options(format, part, abbrev, join_tokens, join_part)");
    {
	bt_name_format *        format = (bt_name_format *) SvIV (ST(0));
	bt_namepart	part = (bt_namepart)SvIV(ST(1));
	bool        abbrev = (SvOK (ST(2))) ? (int) SvIV (ST(2)) : 0;
	bt_joinmethod	join_tokens = (bt_joinmethod)SvIV(ST(3));
	bt_joinmethod	join_part = (bt_joinmethod)SvIV(ST(4));
#line 479 "BibTeX.xs"
       DBG_ACTION (2,
          printf ("XS _set_options: format=%p, part=%d, "
                  "abbrev=%d, join_tokens=%d, join_part=%d\n",
                  format, part, abbrev, join_tokens, join_part))
       bt_set_format_options (format, part, 
                              abbrev, join_tokens, join_part);
#line 621 "BibTeX.c"
    }
    XSRETURN_EMPTY;
}

XS(XS_Text__BibTeX__NameFormat_format_name); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX__NameFormat_format_name)
{
    dXSARGS;
    if (items != 2)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::NameFormat::format_name(name, format)");
    {
	bt_name *        name = (bt_name *) SvIV (ST(0));
	bt_name_format *        format = (bt_name_format *) SvIV (ST(1));
	char *	RETVAL;
	dXSTARG;
#line 493 "BibTeX.xs"
       DBG_ACTION 
          (2, printf ("XS format_name: name=%p, format=%p\n", name, format))
       RETVAL = bt_format_name (name, format);
       DBG_ACTION
          (1, printf ("XS format_name: formatted name=%s\n", RETVAL))

#line 644 "BibTeX.c"
	sv_setpv(TARG, RETVAL); XSprePUSH; PUSHTARG;
    }
    XSRETURN(1);
}

XS(XS_Text__BibTeX_add_macro_text); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX_add_macro_text)
{
    dXSARGS;
    if (items < 2 || items > 4)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::add_macro_text(macro, text, filename=NULL, line=0)");
    {
	char *	macro = (SvOK (ST(0))) ? (char *) SvPV (ST(0),PL_na) : NULL;
	char *	text = (SvOK (ST(1))) ? (char *) SvPV (ST(1),PL_na) : NULL;
	char *	filename;
	int	line;

	if (items < 3)
	    filename = NULL;
	else {
	    filename = (SvOK (ST(2))) ? (char *) SvPV (ST(2),PL_na) : NULL;
	}

	if (items < 4)
	    line = 0;
	else {
	    line = (int)SvIV(ST(3));
	}

	bt_add_macro_text(macro, text, filename, line);
    }
    XSRETURN_EMPTY;
}

XS(XS_Text__BibTeX_delete_macro); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX_delete_macro)
{
    dXSARGS;
    if (items != 1)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::delete_macro(macro)");
    {
	char *	macro = (SvOK (ST(0))) ? (char *) SvPV (ST(0),PL_na) : NULL;

	bt_delete_macro(macro);
    }
    XSRETURN_EMPTY;
}

XS(XS_Text__BibTeX_delete_all_macros); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX_delete_all_macros)
{
    dXSARGS;
    if (items != 0)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::delete_all_macros()");
    {

	bt_delete_all_macros();
    }
    XSRETURN_EMPTY;
}

XS(XS_Text__BibTeX_macro_length); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX_macro_length)
{
    dXSARGS;
    if (items != 1)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::macro_length(macro)");
    {
	char *	macro = (SvOK (ST(0))) ? (char *) SvPV (ST(0),PL_na) : NULL;
	int	RETVAL;
	dXSTARG;

	RETVAL = bt_macro_length(macro);
	XSprePUSH; PUSHi((IV)RETVAL);
    }
    XSRETURN(1);
}

XS(XS_Text__BibTeX_macro_text); /* prototype to pass -Wmissing-prototypes */
XS(XS_Text__BibTeX_macro_text)
{
    dXSARGS;
    if (items < 1 || items > 3)
	Perl_croak(aTHX_ "Usage: Text::BibTeX::macro_text(macro, filename=NULL, line=0)");
    {
	char *	macro = (SvOK (ST(0))) ? (char *) SvPV (ST(0),PL_na) : NULL;
	char *	filename;
	int	line;
	char *	RETVAL;
	dXSTARG;

	if (items < 2)
	    filename = NULL;
	else {
	    filename = (SvOK (ST(1))) ? (char *) SvPV (ST(1),PL_na) : NULL;
	}

	if (items < 3)
	    line = 0;
	else {
	    line = (int)SvIV(ST(2));
	}

	RETVAL = bt_macro_text(macro, filename, line);
	sv_setpv(TARG, RETVAL); XSprePUSH; PUSHTARG;
    }
    XSRETURN(1);
}

#ifdef __cplusplus
extern "C"
#endif
XS(boot_Text__BibTeX); /* prototype to pass -Wmissing-prototypes */
XS(boot_Text__BibTeX)
{
    dXSARGS;
    char* file = __FILE__;

    XS_VERSION_BOOTCHECK ;

        newXSproto("Text::BibTeX::constant", XS_Text__BibTeX_constant, file, "$");
        newXSproto("Text::BibTeX::initialize", XS_Text__BibTeX_initialize, file, "");
        newXSproto("Text::BibTeX::cleanup", XS_Text__BibTeX_cleanup, file, "");
        newXSproto("Text::BibTeX::split_list", XS_Text__BibTeX_split_list, file, "$$;$$$");
        newXSproto("Text::BibTeX::purify_string", XS_Text__BibTeX_purify_string, file, "$;$");
        newXSproto("Text::BibTeX::change_case", XS_Text__BibTeX_change_case, file, "$$;$");
        newXSproto("Text::BibTeX::Entry::_parse", XS_Text__BibTeX__Entry__parse, file, "$$$;$");
        newXSproto("Text::BibTeX::Entry::_parse_s", XS_Text__BibTeX__Entry__parse_s, file, "$$;$");
#if XSubPPtmpAAAA
        newXSproto("Text::BibTeX::Name::dump_name", XS_Text__BibTeX__Name_dump_name, file, "$");
#endif
        newXSproto("Text::BibTeX::Name::_split", XS_Text__BibTeX__Name__split, file, "$$$$$$");
        newXSproto("Text::BibTeX::Name::free", XS_Text__BibTeX__Name_free, file, "$");
        newXSproto("Text::BibTeX::NameFormat::create", XS_Text__BibTeX__NameFormat_create, file, ";$$");
        newXSproto("Text::BibTeX::NameFormat::free", XS_Text__BibTeX__NameFormat_free, file, "$");
#if XSubPPtmpAAAB
        newXSproto("Text::BibTeX::NameFormat::dump_format", XS_Text__BibTeX__NameFormat_dump_format, file, "$");
#endif
        newXSproto("Text::BibTeX::NameFormat::_set_text", XS_Text__BibTeX__NameFormat__set_text, file, "$$$$$$");
        newXSproto("Text::BibTeX::NameFormat::_set_options", XS_Text__BibTeX__NameFormat__set_options, file, "$$$$$");
        newXSproto("Text::BibTeX::NameFormat::format_name", XS_Text__BibTeX__NameFormat_format_name, file, "$$");
        newXSproto("Text::BibTeX::add_macro_text", XS_Text__BibTeX_add_macro_text, file, "$$;$$");
        newXSproto("Text::BibTeX::delete_macro", XS_Text__BibTeX_delete_macro, file, "$");
        newXSproto("Text::BibTeX::delete_all_macros", XS_Text__BibTeX_delete_all_macros, file, "");
        newXSproto("Text::BibTeX::macro_length", XS_Text__BibTeX_macro_length, file, "$");
        newXSproto("Text::BibTeX::macro_text", XS_Text__BibTeX_macro_text, file, "$;$$");

    /* Initialisation Section */

#if XSubPPtmpAAAA
#endif
#if XSubPPtmpAAAB
#endif
#line 538 "BibTeX.xs"
    bt_set_stringopts (BTE_MACRODEF, 0);
    bt_set_stringopts (BTE_REGULAR, 0);
    bt_set_stringopts (BTE_COMMENT, 0);
    bt_set_stringopts (BTE_PREAMBLE, 0);

#line 804 "BibTeX.c"

    /* End of Initialisation Section */

    XSRETURN_YES;
}

